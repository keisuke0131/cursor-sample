# 機能仕様書：社員管理システム

## 1. ドキュメント情報

| 項目 | 内容 |
|------|------|
| ドキュメント名 | 機能仕様書 |
| システム名 | 社員管理システム |
| バージョン | 1.0 |
| 作成日 | 2025-12-01 |
| 作成者 | [作成者名] |

---

## 2. 概要

本ドキュメントでは、社員管理システムの各機能の詳細仕様を定義します。

---

## 3. 機能仕様

### 3.1 社員登録機能（F001）

#### 3.1.1 機能概要
新しい社員をシステムに登録します。

#### 3.1.2 入力項目
| 項目名 | データ型 | 必須 | 制約 | 説明 |
|--------|---------|------|------|------|
| name | String | 必須 | 1-100文字 | 社員名 |
| email | String | 必須 | メール形式 | メールアドレス |
| departmentId | Long | 必須 | 存在する部署ID | 部署ID |
| joinDate | LocalDate | 必須 | 有効な日付 | 入社日 |

#### 3.1.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| id | Long | 社員ID |
| employeeNumber | String | 社員番号（自動採番） |
| name | String | 社員名 |
| email | String | メールアドレス |
| department | DepartmentDto | 部署情報 |
| joinDate | LocalDate | 入社日 |
| createdAt | LocalDateTime | 作成日時 |

#### 3.1.4 処理フロー
1. リクエストパラメータのバリデーション
2. メールアドレスの重複チェック
3. 部署の存在チェック
4. 社員番号の自動採番
5. 社員情報をデータベースに保存
6. 登録された社員情報を返却

#### 3.1.5 ビジネスルール
- メールアドレスは重複不可
- 社員番号は自動採番（形式: EMP001, EMP002, ...）
- 部署IDは存在する必要がある

#### 3.1.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| ERR001 | メールアドレスが重複しています | 409 Conflict | 既に登録されているメールアドレス |
| ERR002 | 部署が存在しません | 404 Not Found | 存在しない部署ID |
| ERR003 | バリデーションエラー | 400 Bad Request | リクエストパラメータが不正 |

---

### 3.2 社員一覧取得機能（F002）

#### 3.2.1 機能概要
登録されている社員の一覧を取得します。ページネーションに対応しています。

#### 3.2.2 入力項目
| 項目名 | データ型 | 必須 | デフォルト値 | 説明 |
|--------|---------|------|------------|------|
| page | Integer | 任意 | 0 | ページ番号（0始まり） |
| size | Integer | 任意 | 20 | 1ページあたりの件数 |
| name | String | 任意 | - | 社員名（部分一致検索） |
| departmentId | Long | 任意 | - | 部署ID |

#### 3.2.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| content | List<EmployeeDto> | 社員リスト |
| totalElements | Long | 総件数 |
| totalPages | Integer | 総ページ数 |
| currentPage | Integer | 現在のページ |

#### 3.2.4 処理フロー
1. ページネーションパラメータの取得
2. 検索条件の取得
3. データベースから社員一覧を取得（削除されていないもののみ）
4. ページネーション情報と共に返却

#### 3.2.5 ビジネスルール
- 削除されていない社員のみ取得
- ページネーションは0始まり
- 検索条件はAND条件で適用

#### 3.2.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| - | - | 200 OK | エラーなし |

---

### 3.3 社員詳細取得機能（F003）

#### 3.3.1 機能概要
指定したIDの社員情報を取得します。

#### 3.3.2 入力項目
| 項目名 | データ型 | 必須 | 説明 |
|--------|---------|------|------|
| id | Long | 必須 | 社員ID（パスパラメータ） |

#### 3.3.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| id | Long | 社員ID |
| employeeNumber | String | 社員番号 |
| name | String | 社員名 |
| email | String | メールアドレス |
| department | DepartmentDto | 部署情報 |
| joinDate | LocalDate | 入社日 |
| createdAt | LocalDateTime | 作成日時 |

#### 3.3.4 処理フロー
1. IDで社員を検索（削除されていないもののみ）
2. 存在しない場合は404エラー
3. 社員情報を返却

#### 3.3.5 ビジネスルール
- 削除されていない社員のみ取得可能

#### 3.3.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| ERR004 | 社員が見つかりません | 404 Not Found | 存在しない社員ID、または削除済み |

---

### 3.4 社員更新機能（F004）

#### 3.4.1 機能概要
既存の社員情報を更新します。

#### 3.4.2 入力項目
| 項目名 | データ型 | 必須 | 制約 | 説明 |
|--------|---------|------|------|------|
| id | Long | 必須 | 存在する社員ID | 社員ID（パスパラメータ） |
| name | String | 任意 | 1-100文字 | 社員名 |
| email | String | 任意 | メール形式 | メールアドレス |
| departmentId | Long | 任意 | 存在する部署ID | 部署ID |

#### 3.4.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| id | Long | 社員ID |
| employeeNumber | String | 社員番号 |
| name | String | 社員名 |
| email | String | メールアドレス |
| department | DepartmentDto | 部署情報 |
| joinDate | LocalDate | 入社日 |
| createdAt | LocalDateTime | 作成日時 |

#### 3.4.4 処理フロー
1. IDで社員を検索
2. 存在しない場合は404エラー
3. リクエストパラメータのバリデーション
4. メールアドレスの重複チェック（変更時）
5. 部署の存在チェック（変更時）
6. 社員情報を更新
7. 更新された社員情報を返却

#### 3.4.5 ビジネスルール
- 指定されていない項目は更新しない
- メールアドレス変更時は重複チェックを実施
- 部署変更時は存在チェックを実施

#### 3.4.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| ERR004 | 社員が見つかりません | 404 Not Found | 存在しない社員ID |
| ERR001 | メールアドレスが重複しています | 409 Conflict | 重複するメールアドレス |
| ERR002 | 部署が存在しません | 404 Not Found | 存在しない部署ID |
| ERR003 | バリデーションエラー | 400 Bad Request | リクエストパラメータが不正 |

---

### 3.5 社員削除機能（F005）

#### 3.5.1 機能概要
社員情報を論理削除します。

#### 3.5.2 入力項目
| 項目名 | データ型 | 必須 | 説明 |
|--------|---------|------|------|
| id | Long | 必須 | 社員ID（パスパラメータ） |

#### 3.5.3 出力項目
なし（204 No Content）

#### 3.5.4 処理フロー
1. IDで社員を検索（削除されていないもののみ）
2. 存在しない場合は404エラー
3. 削除日時を設定（論理削除）
4. 204 No Contentを返却

#### 3.5.5 ビジネスルール
- 論理削除を実施（deleted_atを設定）
- 物理削除は実施しない
- 削除後は取得・一覧表示の対象外

#### 3.5.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| ERR004 | 社員が見つかりません | 404 Not Found | 存在しない社員ID、または削除済み |

---

### 3.6 社員検索機能（F006）

#### 3.6.1 機能概要
名前や部署で社員を検索します。社員一覧取得機能の拡張機能です。

#### 3.6.2 入力項目
社員一覧取得機能と同じ（name、departmentIdパラメータを使用）

#### 3.6.3 出力項目
社員一覧取得機能と同じ

#### 3.6.4 処理フロー
1. 検索条件の取得
2. 名前での部分一致検索（nameパラメータが指定された場合）
3. 部署IDでの検索（departmentIdパラメータが指定された場合）
4. 条件に一致する社員一覧を返却

#### 3.6.5 ビジネスルール
- 名前は部分一致検索
- 複数の検索条件はAND条件で適用
- 削除されていない社員のみ検索対象

#### 3.6.6 エラー処理
社員一覧取得機能と同じ

---

### 3.7 部署一覧取得機能（F007）

#### 3.7.1 機能概要
登録されている部署の一覧を取得します。

#### 3.7.2 入力項目
なし

#### 3.7.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| - | List<DepartmentDto> | 部署リスト |

#### 3.7.4 処理フロー
1. データベースから部署一覧を取得
2. 部署一覧を返却

#### 3.7.5 ビジネスルール
- すべての部署を取得

#### 3.7.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| - | - | 200 OK | エラーなし |

---

### 3.8 部署詳細取得機能（F008）

#### 3.8.1 機能概要
指定したIDの部署情報を取得します。

#### 3.8.2 入力項目
| 項目名 | データ型 | 必須 | 説明 |
|--------|---------|------|------|
| id | Long | 必須 | 部署ID（パスパラメータ） |

#### 3.8.3 出力項目
| 項目名 | データ型 | 説明 |
|--------|---------|------|
| id | Long | 部署ID |
| name | String | 部署名 |
| code | String | 部署コード |

#### 3.8.4 処理フロー
1. IDで部署を検索
2. 存在しない場合は404エラー
3. 部署情報を返却

#### 3.8.5 ビジネスルール
- 存在する部署のみ取得可能

#### 3.8.6 エラー処理
| エラーコード | エラーメッセージ | HTTPステータス | 発生条件 |
|-------------|-----------------|---------------|---------|
| ERR004 | 部署が見つかりません | 404 Not Found | 存在しない部署ID |

---

## 4. 変更履歴

| バージョン | 変更日 | 変更内容 | 変更者 |
|-----------|--------|---------|--------|
| 1.0 | 2025-12-01 | 初版作成 | [作成者名] |

