# 便利なコマンド集

本ドキュメントでは、本プロジェクトで使用する便利なコマンドをまとめています。

## 目次

1. [Mavenビルドコマンド](#mavenビルドコマンド)
2. [テスト実行コマンド](#テスト実行コマンド)
3. [アプリケーション実行コマンド](#アプリケーション実行コマンド)
4. [コードフォーマット・リントコマンド](#コードフォーマットリントコマンド)
5. [依存関係管理コマンド](#依存関係管理コマンド)
6. [データベース関連コマンド](#データベース関連コマンド)
7. [Cursorエージェントチャットで使える便利なコマンド](#cursorエージェントチャットで使える便利なコマンド)

---

## Mavenビルドコマンド

### プロジェクトのクリーンビルド
```bash
mvn clean install
```
- 以前のビルド成果物を削除してから、プロジェクトをビルドします
- テストも同時に実行されます

### テストをスキップしてビルド
```bash
mvn clean install -DskipTests
```
- テストを実行せずにビルドします
- ビルド時間を短縮したい場合に使用

### コンパイルのみ実行
```bash
mvn compile
```
- ソースコードをコンパイルします
- テストやパッケージングは実行しません

### パッケージング（JARファイル作成）
```bash
mvn package
```
- コンパイル、テスト、JARファイルの作成まで実行します

### クリーンアップ
```bash
mvn clean
```
- `target/`ディレクトリを削除します
- ビルド成果物を完全にクリアしたい場合に使用

---

## テスト実行コマンド

### すべてのテストを実行
```bash
mvn test
```
- プロジェクト内のすべてのテストを実行します

### 特定のテストクラスを実行
```bash
mvn test -Dtest=EmployeeServiceTest
```
- 指定したテストクラスのみを実行します

### 特定のテストメソッドを実行
```bash
mvn test -Dtest=EmployeeServiceTest#testCreateEmployee
```
- 指定したテストメソッドのみを実行します

### パターンマッチでテストを実行
```bash
mvn test -Dtest=*ServiceTest
```
- 名前が`*ServiceTest`にマッチするすべてのテストクラスを実行します

### テストレポートの確認
```bash
mvn test
# レポートは target/surefire-reports/ に生成されます
```

### テストカバレッジの確認（JaCoCo使用時）
```bash
mvn clean test jacoco:report
# レポートは target/site/jacoco/ に生成されます
```

---

## アプリケーション実行コマンド

### Spring Bootアプリケーションを起動
```bash
mvn spring-boot:run
```
- 開発用にアプリケーションを起動します
- ホットリロードが有効な場合、コード変更が自動反映されます

### JARファイルから起動
```bash
java -jar target/employee-management-system-1.0.0.jar
```
- ビルド済みのJARファイルからアプリケーションを起動します

### プロファイルを指定して起動
```bash
mvn spring-boot:run -Dspring-boot.run.profiles=test
```
- 指定したプロファイル（例：test）でアプリケーションを起動します

### デバッグモードで起動
```bash
mvn spring-boot:run -Dspring-boot.run.jvmArguments="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005"
```
- デバッグポート5005でリモートデバッグを有効にします
- IDEから接続してデバッグ可能

---

## コードフォーマット・リントコマンド

### コードフォーマット（Checkstyle使用時）
```bash
mvn checkstyle:check
```
- コードスタイルのチェックを実行します

### コードフォーマット（SpotBugs使用時）
```bash
mvn spotbugs:check
```
- バグパターンの検出を実行します

### PMDによる静的解析
```bash
mvn pmd:check
```
- コード品質のチェックを実行します

---

## 依存関係管理コマンド

### 依存関係の表示
```bash
mvn dependency:tree
```
- プロジェクトの依存関係ツリーを表示します
- 依存関係の競合を確認する際に便利

### 依存関係の更新確認
```bash
mvn versions:display-dependency-updates
```
- 更新可能な依存関係を確認します

### 依存関係のダウンロード
```bash
mvn dependency:resolve
```
- 依存関係をダウンロードします（ビルド時に自動実行されます）

### 依存関係のコピー
```bash
mvn dependency:copy-dependencies
```
- 依存関係のJARファイルを`target/dependency/`にコピーします

---

## データベース関連コマンド

### H2データベースコンソールへのアクセス
アプリケーション起動後、ブラウザで以下にアクセス：
```
http://localhost:8080/h2-console
```

接続情報：
- JDBC URL: `jdbc:h2:mem:testdb`
- ユーザー名: `sa`
- パスワード: （空欄）

### データベーススキーマの確認
```bash
# schema.sqlを確認
cat src/main/resources/schema.sql

# 初期データを確認
cat src/main/resources/data.sql
```

---

## Cursorエージェントチャットで使える便利なコマンド

### ファイル参照コマンド
```
@ファイルパス
```
- 特定のファイルを参照して質問や編集を依頼できます
- 例: `@src/main/java/com/company/system/service/EmployeeService.java をレビューしてください`

### ディレクトリ参照コマンド
```
@ディレクトリパス
```
- ディレクトリ内のファイルを参照できます
- 例: `@src/main/java/com/company/system/controller/ のすべてのコントローラーを確認してください`

### 複数ファイル参照
```
@ファイル1 @ファイル2 @ファイル3
```
- 複数のファイルを同時に参照できます
- 例: `@EmployeeService.java @EmployeeController.java の整合性を確認してください`

### 設計書参照
```
@docs/03_詳細設計書テンプレート.md を参照して、[機能名]の詳細設計書を作成してください
```

### 実装依頼
```
@docs/05_サンプルシステム設計書.md の[クラス名]を実装してください。
パッケージは com.company.system.[レイヤー] です。
```

### テスト作成依頼
```
@src/main/java/com/company/system/service/EmployeeService.java の
単体テストを作成してください。
JUnit 5とMockitoを使用してください。
```

### コードレビュー依頼
```
@src/main/java/com/company/system/service/EmployeeService.java を
レビューしてください。改善点があれば指摘してください。
```

### バグ修正依頼
```
@src/main/java/com/company/system/service/EmployeeService.java の
[メソッド名]で発生している[エラー内容]を修正してください。
```

### リファクタリング依頼
```
@src/main/java/com/company/system/service/EmployeeService.java を
リファクタリングしてください。[具体的な改善点]を考慮してください。
```

### ドキュメント生成依頼
```
@src/main/java/com/company/system/service/EmployeeService.java の
JavaDocコメントを追加してください。
```

### テスト実行結果の確認
```
テストを実行して、結果を確認してください。
```

### コード検索
```
[キーワード]を含むコードを検索してください。
```

### パターン検索
```
[パターン]に一致するコードをすべて見つけてください。
```

---

## よく使うコマンドの組み合わせ

### クリーンビルド → テスト実行 → アプリケーション起動
```bash
mvn clean install && mvn spring-boot:run
```

### テストのみ実行（ビルドスキップ）
```bash
mvn test-compile test
```

### 特定のテストを実行してからアプリケーション起動
```bash
mvn test -Dtest=EmployeeServiceTest && mvn spring-boot:run
```

### 依存関係の確認 → ビルド → テスト
```bash
mvn dependency:tree && mvn clean install
```

---

## トラブルシューティング

### ビルドエラーが発生した場合
```bash
# 1. クリーンアップ
mvn clean

# 2. 依存関係の再ダウンロード
mvn dependency:resolve

# 3. 再ビルド
mvn clean install
```

### テストが失敗する場合
```bash
# 特定のテストのみ実行して詳細を確認
mvn test -Dtest=EmployeeServiceTest -X
```

### ポートが使用中の場合
```bash
# ポート8080を使用しているプロセスを確認（macOS/Linux）
lsof -i :8080

# プロセスを終了
kill -9 [PID]
```

---

## 参考リンク

- [Maven公式ドキュメント](https://maven.apache.org/guides/)
- [Spring Boot公式ドキュメント](https://spring.io/projects/spring-boot)
- [Cursor公式ドキュメント](https://cursor.com/ja/docs/agent/chat/commands)

---

## 更新履歴

- 2024年作成 - 初版作成

