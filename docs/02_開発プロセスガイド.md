# Cursorを使ったJava開発プロセスガイド

## 1. 概要

本ガイドでは、Cursor AIアシスタントを活用したJava開発プロセスの各フェーズにおける作業手順とベストプラクティスを説明します。

## 2. 開発フェーズとCursorの活用方法

### 2.1 詳細設計フェーズ

#### 2.1.1 作業内容
- 要件定義書を基に詳細設計書を作成
- クラス設計、メソッド設計、データベース設計
- API設計（エンドポイント、リクエスト/レスポンス）

#### 2.1.2 Cursorでの作業方法
1. **設計書の作成**
   ```
   @docs/03_詳細設計書テンプレート.md を参照して、[機能名]の詳細設計書を作成してください
   ```

2. **クラス設計の支援**
   ```
   以下の要件を満たすクラス設計を提案してください:
   - [要件1]
   - [要件2]
   ```

3. **API設計の支援**
   ```
   RESTful APIのエンドポイント設計をしてください。
   エンティティは[Entity名]で、CRUD操作が必要です。
   ```

#### 2.1.3 成果物
- 詳細設計書（`docs/`配下）
- クラス図（テキスト形式または画像）
- API仕様書

---

### 2.2 実装フェーズ

#### 2.2.1 作業内容
- 詳細設計書に基づいてソースコードを実装
- コーディング規約に従った実装
- コードレビュー準備

#### 2.2.2 Cursorでの作業方法

1. **新規クラスの作成**
   ```
   @docs/05_サンプルシステム設計書.md の[クラス名]を実装してください。
   パッケージは com.company.system.[レイヤー] です。
   ```

2. **既存コードの拡張**
   ```
   @src/main/java/com/company/system/service/UserService.java に
   [機能名]メソッドを追加してください。
   ```

3. **リファクタリング**
   ```
   @src/main/java/com/company/system/controller/UserController.java を
   リファクタリングして、可読性を向上させてください。
   ```

4. **エラーハンドリングの追加**
   ```
   例外処理を追加してください。
   カスタム例外クラスを作成し、適切なエラーメッセージを返すようにしてください。
   ```

#### 2.2.3 実装時のベストプラクティス
- 設計書を参照しながら実装
- 小さな単位で実装し、頻繁にコミット
- 実装前にCursorに設計の確認を依頼
- コードレビューを意識した実装

#### 2.2.4 成果物
- ソースコード（`src/main/java/`配下）
- 実装完了報告

---

### 2.3 単体テストフェーズ

#### 2.3.1 作業内容
- JUnitを使用した単体テストの作成
- テストケースの設計と実装
- カバレッジの確認

#### 2.3.2 Cursorでの作業方法

1. **テストクラスの作成**
   ```
   @src/main/java/com/company/system/service/UserService.java の
   単体テストを作成してください。
   JUnit 5とMockitoを使用してください。
   ```

2. **テストケースの追加**
   ```
   @test/java/com/company/system/unit/UserServiceTest.java に
   以下のテストケースを追加してください:
   - 正常系: ユーザーが正常に作成される
   - 異常系: 重複するメールアドレスでエラー
   ```

3. **モックの設定**
   ```
   Repositoryのモックを設定し、テストデータを返すようにしてください。
   ```

4. **カバレッジの向上**
   ```
   テストカバレッジを向上させるために、不足しているテストケースを追加してください。
   ```

#### 2.3.3 テスト設計の確認
```
@test-docs/単体テスト設計書.md のテストケースを実装してください。
```

#### 2.3.4 成果物
- 単体テストコード（`test/java/unit/`配下）
- テスト実行結果
- カバレッジレポート

---

### 2.4 結合テストフェーズ

#### 2.4.1 作業内容
- 複数クラス間の連携テスト
- データベースとの結合テスト
- 外部APIとの結合テスト

#### 2.4.2 Cursorでの作業方法

1. **結合テストの作成**
   ```
   UserServiceとUserRepositoryの結合テストを作成してください。
   H2 Databaseを使用して、実際のデータベース操作をテストしてください。
   ```

2. **トランザクションテスト**
   ```
   トランザクションのロールバックが正しく動作することを確認するテストを追加してください。
   ```

3. **外部API連携テスト**
   ```
   外部APIとの連携をモックしてテストしてください。
   WireMockを使用してください。
   ```

#### 2.4.3 成果物
- 結合テストコード（`test/java/integration/`配下）
- テスト実行結果

---

### 2.5 システムテストフェーズ

#### 2.5.1 作業内容
- エンドツーエンドのテスト
- 実際の環境での動作確認
- パフォーマンステスト

#### 2.5.2 Cursorでの作業方法

1. **システムテストの作成**
   ```
   REST APIのエンドツーエンドテストを作成してください。
   Spring Boot Testを使用して、実際のアプリケーションを起動してテストしてください。
   ```

2. **テストシナリオの実装**
   ```
   @test-docs/システムテスト設計書.md のシナリオを実装してください。
   ```

3. **パフォーマンステスト**
   ```
   負荷テストのシナリオを作成してください。
   ```

#### 2.5.3 成果物
- システムテストコード（`test/java/system/`配下）
- テスト実行結果
- パフォーマンスレポート

---

## 3. Cursorの効果的な使い方

### 3.1 コンテキストの提供
Cursorに作業を依頼する際は、関連するファイルやドキュメントを参照させることが重要です。

**良い例:**
```
@docs/05_サンプルシステム設計書.md と
@src/main/java/com/company/system/model/User.java を参照して、
UserServiceを実装してください。
```

**悪い例:**
```
UserServiceを実装してください。
```

### 3.2 段階的な実装
大きな機能は小さな単位に分割して実装します。

1. まず設計書を作成
2. モデルクラスを実装
3. リポジトリを実装
4. サービスを実装
5. コントローラーを実装
6. テストを実装

### 3.3 コードレビューの依頼
実装後、Cursorにコードレビューを依頼できます。

```
@src/main/java/com/company/system/service/UserService.java を
レビューしてください。改善点があれば指摘してください。
```

### 3.4 ドキュメント生成
実装コードからJavaDocを自動生成できます。

```
@src/main/java/com/company/system/service/UserService.java の
JavaDocコメントを追加してください。
```

---

## 4. 開発フロー

```
1. 詳細設計書作成
   ↓
2. 実装
   ↓
3. 単体テスト作成・実行
   ↓
4. 結合テスト作成・実行
   ↓
5. システムテスト作成・実行
   ↓
6. コードレビュー
   ↓
7. リリース
```

---

## 5. トラブルシューティング

### 5.1 コンパイルエラー
```
@src/main/java/com/company/system/service/UserService.java の
コンパイルエラーを修正してください。
```

### 5.2 テスト失敗
```
@test/java/com/company/system/unit/UserServiceTest.java の
テストが失敗しています。原因を特定して修正してください。
```

### 5.3 パフォーマンス問題
```
@src/main/java/com/company/system/service/UserService.java の
パフォーマンスを改善してください。
```

---

## 6. チェックリスト

### 実装前
- [ ] 詳細設計書が完成している
- [ ] 実装方針が明確になっている
- [ ] 必要な依存関係が確認できている

### 実装中
- [ ] コーディング規約に従っている
- [ ] 適切な例外処理が実装されている
- [ ] ログ出力が適切に実装されている

### 実装後
- [ ] 単体テストがすべてパスしている
- [ ] コードレビューが完了している
- [ ] ドキュメントが更新されている

### テスト
- [ ] 単体テストカバレッジが80%以上
- [ ] 結合テストがすべてパスしている
- [ ] システムテストがすべてパスしている

